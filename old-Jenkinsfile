pipeline{
    agent any
parameters {
        booleanParam(name: 'CLIENTE_SA', defaultValue: false, description: 'Cliente flag')
        booleanParam(name: 'EQUIPO_SA', defaultValue: false, description: 'Equipo flag')
        booleanParam(name: 'PARTIDO_SA', defaultValue: false, description: 'Partido flag')
        booleanParam(name: 'COMPETENCIA_SA', defaultValue: false, description: 'Competencia flag')
        booleanParam(name: 'ESTADIO_SA', defaultValue: false, description: 'Estadio flag')
        booleanParam(name: 'DIRECTOR_SA', defaultValue: false, description: 'Director flag')
        booleanParam(name: 'JUGADOR_SA', defaultValue: false, description: 'Jugador flag')
        booleanParam(name: 'NOTICIA_SA', defaultValue: false, description: 'Noticia flag')
        booleanParam(name: 'PREDICCION_SA', defaultValue: false, description: 'Prediccion flag')
        booleanParam(name: 'AUTENTICACION_SA', defaultValue: false, description: 'Autenticacion flag')
        booleanParam(name: 'ADMINISTRADOR_SA', defaultValue: false, description: 'Administrador flag')
        booleanParam(name: 'EMPLEADO_SA', defaultValue: false, description: 'Empleado flag')
        booleanParam(name: 'PAIS_SA', defaultValue: false, description: 'Pais flag')
    }
    stages {
        stage("build"){
            steps{
                dir("SoccerStats"){
                    sh 'cd ./backend/administrative'
                    sh 'docker login -u bitochepe -p a596b343-ee91-47c8-a5c3-f49d76f8982c'
                    sh 'docker build -t bitochepe/administrative-image-sa'
                    sh 'docker push bitochepe/administrative-image-sa'
                }
            }
        }

        stage("test"){
            steps{
                dir("SoccerStats"){
                    sh 'npm test'
                }
            }
        }

        stage("Upload Images"){
            steps{
                dir("SoccerStats"){
                    sh 'docker login -u "bitochepe" -p "a596b343-ee91-47c8-a5c3-f49d76f8982c"'
                    sh 'docker build -t bitochepe/pareja4:v1 .'
                    sh 'docker push bitochepe/pareja4:v1'
                }
            }
        }

        stage("Deploy Ansible"){
            steps{
                dir("SoccerStats"){
                    sh 'ansible-playbook ansible-production.yml'
                }
            }
        }
    }
}
